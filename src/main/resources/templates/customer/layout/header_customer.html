<div xmlns:th="http://www.thymeleaf.org">
	<div class="container-fluid">
		<div class="row bg-secondary py-1 px-xl-5">
			<div class="col-lg-6 d-none d-lg-block">
				<div class="d-inline-flex align-items-center h-100">
					<a class="text-body mr-3" href="">About</a> <a
						class="text-body mr-3" href="">Contact</a> <a
						class="text-body mr-3" href="">Help</a> <a class="text-body mr-3"
						href="">FAQs</a>
				</div>
			</div>
			<div class="col-lg-6 text-center text-lg-right">
				<div class="d-inline-flex align-items-center">
					<div class="btn-group">
						<button type="button" class="btn btn-sm btn-light dropdown-toggle"
							data-toggle="dropdown">
							<!-- Display the user's name if logged in, otherwise show "My Account" -->
							<span
								th:text="${logined != null} ? ${loginedname} : 'My Account'"></span>
						</button>
						<div class="dropdown-menu dropdown-menu-right">
							<!-- Check if user is logged in -->
							<div th:if="${logined != null}">
								<a href="/account/cusinfo" class="dropdown-item">Customer
									Info</a> <a href="/order/showorder" class="dropdown-item">Ordered</a>
								<a href="/account/logout" class="dropdown-item">Logout</a>
							</div>
							<div th:if="${logined == null}">
								<a href="/account/signin" class="dropdown-item">Sign in</a> <a
									href="/account/signup" class="dropdown-item">Sign up</a>
							</div>
						</div>

					</div>

				</div>
				<div class="d-inline-flex align-items-center d-block d-lg-none">
					<a href="/cart/showcart" class="btn px-0 ml-2"> <i
						class="fas fa-shopping-cart text-dark"></i> <span
						class="badge text-dark border border-dark rounded-circle"
						style="padding-bottom: 2px;">0</span>
					</a>
				</div>
			</div>
		</div>
		<div
			class="row align-items-center bg-light py-3 px-xl-5 d-none d-lg-flex">
			<div class="col-lg-4">
				<a href="" class="text-decoration-none"> <span
					class="h1 text-uppercase text-primary bg-dark px-2"><img
						style="height: 40px;" src="/customer/img/sse.png">Electro</span> <span
					class="h1 text-uppercase text-dark bg-primary px-2 ml-n1">Sphere</span>
				</a>
			</div>
			<div class="col-lg-4 col-6 text-left">
				<form th:action="@{/search/gosppws}">
					<div class="input-group osearch" Onclick="toggleDropdown()">
						<input type="text" id="searchInput" name="search"
							class="form-control" placeholder="Search for products">
						<div class="input-group-append">
							<span class="input-group-text bg-transparent text-primary">
								<i class="fa fa-search"></i>
							</span>
						</div>
						<div class="searchDropdown">
							<div class="thuandropdown-item">
								<a></a>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="col-lg-4 col-6 text-right">
				<p class="m-0">Customer Service</p>
				<h5 class="m-0">+012 345 6789</h5>
			</div>
		</div>
	</div>
	<!-- Topbar End -->


	<!-- Navbar Start -->
	<div class="container-fluid bg-dark mb-30">
		<div class="row px-xl-5">
			<div class="col-lg-3 d-none d-lg-block">
				<a
					class="btn d-flex align-items-center justify-content-between bg-primary w-100"
					data-toggle="collapse" href="#navbar-vertical"
					style="height: 65px; padding: 0 30px;">
					<h6 class="text-dark m-0">
						<i class="fa fa-bars mr-2"></i>Menu
					</h6> <i class="fa fa-angle-down text-dark"></i>
				</a>

				<nav
					class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 bg-light"
					id="navbar-vertical"
					style="width: calc(100% - 30px); z-index: 999;">
					<div class="navbar-nav w-100">
						<div class="nav-item dropdown dropright">
							<a href="#" class="nav-link dropdown-toggle"
								data-toggle="dropdown">Categories <i
								class="fa fa-angle-right float-right mt-1"></i></a>
							<div
								class="dropdown-menu position-absolute rounded-0 border-0 m-0 menudropdown">
								<a th:each="item : ${categorys}"
									th:href="@{'/shoppingpage/setcate/' + ${item.Id}}"
									class="nav-item nav-link"><span th:text="${item.name}"></span></a>
							</div>
						</div>
						<div class="nav-item dropdown dropright">
							<a href="#" class="nav-link dropdown-toggle"
								data-toggle="dropdown">Brands <i
								class="fa fa-angle-right float-right mt-1"></i></a>
							<div
								class="dropdown-menu position-absolute rounded-0 border-0 m-0 menudropdown">
								<a th:each="item : ${brands}"
									th:href="@{'/shoppingpage/setbrand/' + ${item.Id}}"
									class="nav-item nav-link"><span th:text="${item.name}"></span></a>
							</div>
						</div>


					</div>
				</nav>
			</div>
			<div class="col-lg-9">
				<nav
					class="navbar navbar-expand-lg bg-dark navbar-dark py-3 py-lg-0 px-0">
					<a href="" class="text-decoration-none d-block d-lg-none"> <span
						class="h1 text-uppercase text-dark bg-light px-2">Electro</span> <span
						class="h1 text-uppercase text-light bg-primary px-2 ml-n1">Sphere</span>
					</a>
					<button type="button" class="navbar-toggler" data-toggle="collapse"
						data-target="#navbarCollapse">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse justify-content-between"
						id="navbarCollapse">
						<div class="navbar-nav mr-auto py-0">

							<a href="/"
								th:class="${currentURI != null && currentURI.equals('/') ? 'nav-item nav-link active' : 'nav-item nav-link'}">Home</a>
							<a href="/shoppingpage/reset"
								th:class="${currentURI != null && currentURI.equals('/shoppingpage') ? 'nav-item nav-link active' : 'nav-item nav-link'}">Shop</a>
							<a href="/contact"
								th:class="${currentURI != null && currentURI.equals('/contact') ? 'nav-item nav-link active' : 'nav-item nav-link'}">Contact</a>





							<!-- <div class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Pages <i class="fa fa-angle-down mt-1"></i></a>
                                <div class="dropdown-menu bg-primary rounded-0 border-0 m-0">
                                    <a href="cart.html" class="dropdown-item">Shopping Cart</a>
                                    <a href="checkout.html" class="dropdown-item">Checkout</a>
                                </div>
                            </div> -->

						</div>
						<div class="navbar-nav ml-auto py-0 d-none d-lg-block">

							<a href="/cart/showcart" class="btn px-0 ml-3"> <i
								class="fas fa-shopping-cart text-primary"></i> <span
								class="badge text-secondary border border-secondary rounded-circle"
								id="numberquantitycart" style="padding-bottom: 2px;"
								th:text="${Cquantity != null ? Cquantity : 0}"></span>

							</a>
						</div>
					</div>
				</nav>
			</div>
		</div>
	</div>

</div>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
	integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
	crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
$(document).ready(function() {
    let typingTimer;  
    const doneTypingInterval = 500;
    const searchInput = $('#searchInput');  

    // Khi người dùng gõ phím trong ô tìm kiếm
    searchInput.on('keyup', function() {
        clearTimeout(typingTimer);  // Reset lại timer mỗi khi gõ phím
        typingTimer = setTimeout(doneTyping, doneTypingInterval);  // Bắt đầu timer
    });

    // Xử lý khi người dùng ngừng gõ sau 0.5 giây
    function doneTyping() {
        const searchQuery = searchInput.val();

       
        if (searchQuery.length > 0) {
           
            $.ajax({
                url: '/search/product',  
                method: 'GET',
                data: { stringsearch: searchQuery },
                success: function(response) {
                  
                    renderDropdown(response);
                },
                error: function(xhr, status, error) {
                    console.error("Error fetching products:", error);
                }
            });
        }
    }
 // Hàm hiển thị danh sách sản phẩm vào dropdown
    function renderDropdown(products) {
        const dropdown = $('.searchDropdown');
        dropdown.empty();  // Xóa tất cả nội dung cũ của dropdown

        // Kiểm tra nếu không có sản phẩm nào
        if (products.length === 0) {
            const noProductDiv = `
                <div class="thuandropdown-item">
                    <span style="margin-left:20px;">No products found</span>
                </div>
            `;
            dropdown.append(noProductDiv);  // Thêm dòng "No products found"
        } else {
            
        	products.forEach(product => {
        		console.log(product)
        	    const productDiv = `
        	        <div class="thuandropdown-item">
        	            <img src="/uploads/${product.img}" alt="${product.product_name}" style="width: 40px; height: 40px; margin-right: 10px;">
        	            <a href="/detailproduct/product?id=${product.id}">${product.product_name}</a>
        	        </div>
        	    `;
        	    dropdown.append(productDiv);
        	});

            // Bắt sự kiện khi người dùng chọn sản phẩm trong dropdown
          
        }
    }

   
});

</script>
